{"version":3,"names":[],"mappings":"","sources":["src/bezier3-intersection/geo-clip.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst flo_poly_1 = require(\"flo-poly\");\nconst to_hybrid_quadratic_1 = require(\"../to-hybrid-quadratic\");\n/**\n * @param P\n * @param dQ\n * @param dMin\n * @param dMax\n */\nfunction geoClip(P, dQ, dMin, dMax) {\n    let hq = to_hybrid_quadratic_1.toHybridQuadratic(P);\n    let dH0 = dQ(hq[0]);\n    let dH2 = dQ(hq[2]);\n    let dH10 = dQ(hq[1][0]);\n    let dH11 = dQ(hq[1][1]);\n    let dHmin = Math.min(dH10, dH11);\n    let dHmax = Math.max(dH10, dH11);\n    let DyMin = [\n        dH0 - 2 * dHmin + dH2,\n        -2 * dH0 + 2 * dHmin,\n        dH0\n    ];\n    let DyMax = [\n        dH0 - 2 * dHmax + dH2,\n        -2 * dH0 + 2 * dHmax,\n        dH0\n    ];\n    let errorBound = 2 * Math.max(flo_poly_1.default.hornerErrorBound(DyMin, 1), flo_poly_1.default.hornerErrorBound(DyMax, 1));\n    dMin = dMin - errorBound;\n    dMax = dMax + errorBound;\n    let DyMinMin = DyMin.slice();\n    DyMinMin[2] = DyMinMin[2] - dMin;\n    let DyMinMax = DyMin.slice();\n    DyMinMax[2] = DyMinMax[2] - dMax;\n    let DyMaxMin = DyMax.slice();\n    DyMaxMin[2] = DyMaxMin[2] - dMin;\n    let DyMaxMax = DyMax.slice();\n    DyMaxMax[2] = DyMaxMax[2] - dMax;\n    let tMin = Number.POSITIVE_INFINITY;\n    let tMax = Number.NEGATIVE_INFINITY;\n    let rootsMinMin = flo_poly_1.default.allRoots(DyMinMin, 0, 1);\n    let rootsMinMax = flo_poly_1.default.allRoots(DyMinMax, 0, 1);\n    let rootsMaxMin = flo_poly_1.default.allRoots(DyMaxMin, 0, 1);\n    let rootsMaxMax = flo_poly_1.default.allRoots(DyMaxMax, 0, 1);\n    tMin = Math.min(...rootsMinMin, ...rootsMinMax, ...rootsMaxMin, ...rootsMaxMax);\n    tMax = Math.max(...rootsMinMin, ...rootsMinMax, ...rootsMaxMin, ...rootsMaxMax);\n    if (dH0 >= dMin && dH0 <= dMax) {\n        tMin = 0;\n    }\n    if (dH2 >= dMin && dH2 <= dMax) {\n        tMax = 1;\n    }\n    if (tMin < 0) {\n        tMin = 0;\n    }\n    if (tMax > 1) {\n        tMax = 1;\n    }\n    return { tMin, tMax };\n}\nexports.geoClip = geoClip;\n"],"file":"geo-clip.js"}